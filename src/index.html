<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>LexChatBot</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>

<body>
  <app-root></app-root>

  <script>
    const email = 'ontrack@admin.com';
    const password = 'admin';
    const loginBody = `grant_type=password&username=${email}&password=${password}&client_id=nab-client`;

    const _accessToken = '';
    const _apiUrl = 'http://ontrack-prototype.codestream.com.sg/api';
    const _async = true;

    // Execute
    var data = post('token', loginBody, processResponse);
    // var datas = new Promise();

    // --------------- Http Request Web API -----------------------
    function post(url, body, next) {
      const reqUrl = `${_apiUrl}/${url}`;
      var xhr = new XMLHttpRequest();

      xhr.open('POST', reqUrl, _async);
      // xhr.setRequestHeader('Authorization', 'Bearer ' + _accessToken);
      xhr.send(body);
      next(xhr);
      // xhr.onreadystatechange = next(xhr);
    }
    function get(url, next) {
      const reqUrl = `${_apiUrl}/${url}`;
      var xhr = new XMLHttpRequest();

      xhr.open('GET', reqUrl, _async);
      // xhr.setRequestHeader('Authorization', 'Bearer ' + _accessToken);
      xhr.send();
      // xhr.onreadystatechange =  next(xhr, e);
      next(xhr);
    }
    function processResponse(xhr) {
        console.log(xhr);
      if (xhr.readyState == 4 && xhr.status == 200) {
        var token = JSON.parse(xhr.responseText);
        var arraybuffer = xhr.response;
        console.log(arraybuffer, token);

        return xhr.response;
      }
    }

  </script>
</body>

</html>